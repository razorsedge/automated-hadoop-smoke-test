#!/bin/bash
source ./conf/SmokeConfig.config

echo "##########"
echo "IMPALA_SSL_ENABLED: $IMPALA_SSL_ENABLED"
echo "IMPALA_KERBEROS_ENABLED: $IMPALA_KERBEROS_ENABLED"
echo "IMPALA_LDAP_ENABLED: $IMPALA_LDAP_ENABLED"
echo "KUDU_TABLE_NAME: $KUDU_TABLE_NAME"

IMPALA_CONNECT_STRING="--impalad=${IMPALA_DAEMON} --database=${IMPALA_DATABASE_NAME}"
if [ "$IMPALA_SSL_ENABLED" == true ]; then
        IMPALA_CONNECT_STRING="${IMPALA_CONNECT_STRING} ${ITOPTS}"
fi
if [ "$IMPALA_KERBEROS_ENABLED" == true ]; then
        IMPALA_CONNECT_STRING="${IMPALA_CONNECT_STRING} ${IKOPTS}"
fi
if [ "$IMPALA_LDAP_ENABLED" == true ]; then
        IMPALA_CONNECT_STRING="${IMPALA_CONNECT_STRING} ${ILOPTS}"
fi
echo "IMPALA_CONNECT_STRING: ${IMPALA_CONNECT_STRING}"
echo "##########"

# shellcheck disable=SC2086
impala-shell $IMPALA_CONNECT_STRING -q "DROP TABLE ${KUDU_TABLE_NAME};"

rm -f kudu_select_test.txt kudu_check.txt

